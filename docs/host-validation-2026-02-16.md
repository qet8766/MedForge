## Host Validation Evidence (2026-02-16)

Generated by: `infra/host/validate-gate56.sh`

Runtime:
- API URL: `http://127.0.0.1:8000`
- Request API URL: `http://api.medforge.localtest.me:18080`
- Pack image: `medforge-pack-default:local@sha256:7e44d4e67aa5c7bbc51701be7f370f45de35794cc7f2504f761b1a510f1c1a6e`
- DB path: `/home/shk/projects/MedForge/apps/api/gate-evidence.db`
- Browser lane enabled: `true`
- Browser base URL: `http://medforge.localtest.me:18080`
- Browser domain: `localtest.me`
- Browser user: `e2e-1771246186@medforge.test`

### Create Sessions

- create A: `{"data":{"message":"Session started.","session":{"id":"a060ec55-6d6f-45c6-8b9e-93d307322154","user_id":"89ce8b3c-605e-4d53-bd7c-8c60f74f7528","tier":"public","pack_id":"00000000-0000-0000-0000-000000000100","status":"running","container_id":"6025cb516574dd82aa2d92064cd0d22e162d6fcabb634810d742c06f5610b413","gpu_id":0,"slug":"eu765qpe","workspace_zfs":"tank/medforge/workspaces/89ce8b3c-605e-4d53-bd7c-8c60f74f7528/a060ec55-6d6f-45c6-8b9e-93d307322154","created_at":"2026-02-16T12:49:49.451014","started_at":"2026-02-16T12:49:49.756685","stopped_at":null,"error_message":null}},"meta":{"request_id":"f9aecac2-f2ce-4d93-bf7f-43f3e56ba11a","api_version":"v1.0","timestamp":"2026-02-16T12:49:49.762640Z","limit":null,"next_cursor":null,"has_more":null}}`
- create B: `{"data":{"message":"Session started.","session":{"id":"ab774ac1-b6ba-402a-877f-a5b2f6e9369f","user_id":"f682fb57-26c6-4a63-a9ac-539d1d37fddc","tier":"public","pack_id":"00000000-0000-0000-0000-000000000100","status":"running","container_id":"39ddb3e67d0433e64e39fae678e1a89790e5c381de8a26a985b30cab8eb0d27c","gpu_id":1,"slug":"xkknxker","workspace_zfs":"tank/medforge/workspaces/f682fb57-26c6-4a63-a9ac-539d1d37fddc/ab774ac1-b6ba-402a-877f-a5b2f6e9369f","created_at":"2026-02-16T12:49:50.087074","started_at":"2026-02-16T12:49:50.418122","stopped_at":null,"error_message":null}},"meta":{"request_id":"d5501b4a-cdc8-4619-b159-155705d2ed53","api_version":"v1.0","timestamp":"2026-02-16T12:49:50.423569Z","limit":null,"next_cursor":null,"has_more":null}}`

### Gate 5 Auth Matrix

- unauthenticated: `401` body=`{"type":"https://medforge.dev/problems/http/401","title":"Unauthorized","status":401,"detail":"Authentication required.","instance":"/api/v1/auth/session-proxy","code":"401","request_id":"91e3ffc1-9606-4592-95fb-284e9cc4bfe9"}`
- non-owner: `403` body=`{"type":"https://medforge.dev/problems/http/403","title":"Forbidden","status":403,"detail":"Session access denied.","instance":"/api/v1/auth/session-proxy","code":"403","request_id":"b649faa3-04ac-40ed-8bea-4c84fe1f97d6"}`
- owner spoof attempt: `200` x-upstream=`mf-session-eu765qpe:8080`

### Gate 5 Isolation

- firewall: `East–west isolation applied (bridge=br-42fb65ed835a, caddy=172.30.0.2)`
- session B -> session A :8080 blocked (exit=`28`, stderr=`curl: (28) Connection timed out after 3002 milliseconds`)

### Gate 6 End-to-End Core

- GPU in session A: `NVIDIA GeForce RTX 5090`
- workspace write/read: `alpha`
- stop A: `{"data":{"message":"Session stop requested."},"meta":{"request_id":"ba09dc67-e4a9-434d-a0fd-752f9b7e08a9","api_version":"v1.0","timestamp":"2026-02-16T12:49:53.752620Z","limit":null,"next_cursor":null,"has_more":null}}`
- stopped host check: `404` body=`{"type":"https://medforge.dev/problems/http/404","title":"Not Found","status":404,"detail":"Session not found.","instance":"/api/v1/auth/session-proxy","code":"404","request_id":"8a9870e6-3565-4f43-823e-df6947114d8c"}`
- snapshot: `tank/medforge/workspaces/89ce8b3c-605e-4d53-bd7c-8c60f74f7528/a060ec55-6d6f-45c6-8b9e-93d307322154@stop-1771246197404`
- stop B: `{"data":{"message":"Session stop requested."},"meta":{"request_id":"05dcd4c1-550a-4a43-bd3a-067e9e57a21e","api_version":"v1.0","timestamp":"2026-02-16T12:49:58.140968Z","limit":null,"next_cursor":null,"has_more":null}}`

### Gate 5/6 Browser + Websocket

- browser base URL: `http://medforge.localtest.me:18080`
- e2e user: `e2e-1771246186@medforge.test`
- wildcard session URL: `http://s-34ytucvs.medforge.localtest.me:18080`
- wildcard slug: `34ytucvs`
- websocket attempts observed: `1`
- websocket connections with frame traffic: `1`
- websocket auth 403 entries: `0`

### API Log Snippet

```text
INFO:     Started server process [552544]
INFO:     Waiting for application startup.
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2474ec93cdb5, initial_schema
INFO  [alembic.runtime.migration] Running upgrade 2474ec93cdb5 -> a1b2c3d4e5f6, drop_gpu_active
2026-02-16 21:49:49 [info     ] session.start                  gpu_id=0 pack_id=00000000-0000-0000-0000-000000000100 request_id=f9aecac2-f2ce-4d93-bf7f-43f3e56ba11a session_id=a060ec55-6d6f-45c6-8b9e-93d307322154 slug=eu765qpe tier=PUBLIC user_id=89ce8b3c-605e-4d53-bd7c-8c60f74f7528
2026-02-16 21:49:50 [info     ] session.start                  gpu_id=1 pack_id=00000000-0000-0000-0000-000000000100 request_id=d5501b4a-cdc8-4619-b159-155705d2ed53 session_id=ab774ac1-b6ba-402a-877f-a5b2f6e9369f slug=xkknxker tier=PUBLIC user_id=f682fb57-26c6-4a63-a9ac-539d1d37fddc
2026-02-16 21:49:52 [info     ] session.recovery.decision      container_id=6025cb516574dd82aa2d92064cd0d22e162d6fcabb634810d742c06f5610b413 correlation_id=7bab2a9d-1abe-479b-8082-192d13882a4d recovery_mode=poll session_id=a060ec55-6d6f-45c6-8b9e-93d307322154 slug=eu765qpe state=running user_id=89ce8b3c-605e-4d53-bd7c-8c60f74f7528
2026-02-16 21:49:52 [info     ] session.recovery.decision      container_id=39ddb3e67d0433e64e39fae678e1a89790e5c381de8a26a985b30cab8eb0d27c correlation_id=7bab2a9d-1abe-479b-8082-192d13882a4d recovery_mode=poll session_id=ab774ac1-b6ba-402a-877f-a5b2f6e9369f slug=xkknxker state=running user_id=f682fb57-26c6-4a63-a9ac-539d1d37fddc
2026-02-16 21:49:57 [info     ] session.stop                   correlation_id=efe53e8a-1101-4f1a-be66-f869f91dbc73 gpu_id=0 pack_id=00000000-0000-0000-0000-000000000100 reason=requested recovery_mode=poll session_id=a060ec55-6d6f-45c6-8b9e-93d307322154 slug=eu765qpe tier=PUBLIC user_id=89ce8b3c-605e-4d53-bd7c-8c60f74f7528
2026-02-16 21:49:57 [info     ] session.recovery.decision      container_id=39ddb3e67d0433e64e39fae678e1a89790e5c381de8a26a985b30cab8eb0d27c correlation_id=efe53e8a-1101-4f1a-be66-f869f91dbc73 recovery_mode=poll session_id=ab774ac1-b6ba-402a-877f-a5b2f6e9369f slug=xkknxker state=running user_id=f682fb57-26c6-4a63-a9ac-539d1d37fddc
2026-02-16 21:49:57 [info     ] session.poll.updated           correlation_id=efe53e8a-1101-4f1a-be66-f869f91dbc73 recovery_mode=poll updated=1
2026-02-16 21:50:02 [info     ] session.stop                   correlation_id=16eb2e4e-9560-40bf-a448-e790a0bf132f gpu_id=1 pack_id=00000000-0000-0000-0000-000000000100 reason=requested recovery_mode=poll session_id=ab774ac1-b6ba-402a-877f-a5b2f6e9369f slug=xkknxker tier=PUBLIC user_id=f682fb57-26c6-4a63-a9ac-539d1d37fddc
2026-02-16 21:50:02 [info     ] session.poll.updated           correlation_id=16eb2e4e-9560-40bf-a448-e790a0bf132f recovery_mode=poll updated=1
2026-02-16 21:50:16 [info     ] session.start                  gpu_id=0 pack_id=00000000-0000-0000-0000-000000000100 request_id=69196ead-4a22-4f6b-8039-b20081214e42 session_id=e529d113-b473-46a4-a19f-26a9c58c8a2f slug=34ytucvs tier=PUBLIC user_id=45201b0a-7b15-49f7-ae0f-93091070b55a
2026-02-16 21:50:17 [info     ] session.recovery.decision      container_id=4eeb440e01cce5f5cc62b6202b734cdbfe97f644c1ff07067adfd36ccfee1b61 correlation_id=37f357fa-20ea-4f15-9874-188be4674b24 recovery_mode=poll session_id=e529d113-b473-46a4-a19f-26a9c58c8a2f slug=34ytucvs state=running user_id=45201b0a-7b15-49f7-ae0f-93091070b55a
```

### Web Log Snippet

```text

> medforge-web@0.1.0 dev
> next dev --hostname 0.0.0.0 --port 3000

▲ Next.js 16.1.6 (Turbopack)
- Local:         http://localhost:3000
- Network:       http://0.0.0.0:3000

✓ Starting...
✓ Ready in 250ms
 GET / 200 in 387ms (compile: 284ms, render: 102ms)
 GET /auth/login 200 in 163ms (compile: 139ms, render: 24ms)
⚠ Cross origin request detected from medforge.localtest.me to /_next/* resource. In a future major version of Next.js, you will need to explicitly configure "allowedDevOrigins" in next.config to allow this.
Read more: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins
 GET /auth/signup 200 in 177ms (compile: 155ms, render: 23ms)
 GET /sessions 200 in 177ms (compile: 150ms, render: 27ms)
 GET /auth/login 200 in 20ms (compile: 1550µs, render: 19ms)
 GET /sessions 200 in 19ms (compile: 1253µs, render: 17ms)
```

### Caddy Log Snippet

```text
{"level":"info","ts":1771246187.7422705,"msg":"maxprocs: Leaving GOMAXPROCS=128: CPU quota undefined"}
{"level":"info","ts":1771246187.7423599,"msg":"GOMEMLIMIT is updated","package":"github.com/KimMachineGun/automemlimit/memlimit","GOMEMLIMIT":486097521868,"previous":9223372036854775807}
{"level":"info","ts":1771246187.7423744,"msg":"using config from file","file":"/etc/caddy/Caddyfile"}
{"level":"warn","ts":1771246187.7427747,"logger":"caddyfile","msg":"Unnecessary header_up X-Forwarded-For: the reverse proxy's default behavior is to pass headers to the upstream"}
{"level":"warn","ts":1771246187.7427979,"logger":"caddyfile","msg":"Unnecessary header_up X-Forwarded-Proto: the reverse proxy's default behavior is to pass headers to the upstream"}
{"level":"info","ts":1771246187.7431285,"msg":"adapted config to JSON","adapter":"caddyfile"}
{"level":"warn","ts":1771246187.7431304,"msg":"Caddyfile input is not formatted; run 'caddy fmt --overwrite' to fix inconsistencies","adapter":"caddyfile","file":"/etc/caddy/Caddyfile","line":2}
{"level":"info","ts":1771246187.7437623,"logger":"admin","msg":"admin endpoint started","address":"localhost:2019","enforce_origin":false,"origins":["//[::1]:2019","//127.0.0.1:2019","//localhost:2019"]}
{"level":"info","ts":1771246187.7438464,"logger":"http.auto_https","msg":"automatic HTTPS is completely disabled for server","server_name":"srv0"}
{"level":"info","ts":1771246187.7439244,"logger":"tls.cache.maintenance","msg":"started background certificate maintenance","cache":"0xc000960f80"}
{"level":"warn","ts":1771246187.745095,"logger":"http","msg":"HTTP/2 skipped because it requires TLS","network":"tcp","addr":":18080"}
{"level":"warn","ts":1771246187.745132,"logger":"http","msg":"HTTP/3 skipped because it requires TLS","network":"tcp","addr":":18080"}
{"level":"info","ts":1771246187.7451358,"logger":"http.log","msg":"server running","name":"srv0","protocols":["h1","h2","h3"]}
{"level":"info","ts":1771246187.7554064,"logger":"tls","msg":"cleaning storage unit","storage":"FileStorage:/data/caddy"}
{"level":"info","ts":1771246187.7580438,"msg":"autosaved config (load with --resume flag)","file":"/config/caddy/autosave.json"}
{"level":"info","ts":1771246187.7580512,"msg":"serving initial configuration"}
{"level":"info","ts":1771246187.760657,"logger":"tls","msg":"finished cleaning storage units"}
{"level":"error","ts":1771246188.7421641,"logger":"http.log.error","msg":"dial tcp 172.17.0.1:3000: connect: connection refused","request":{"remote_ip":"172.30.0.1","remote_port":"58282","client_ip":"172.30.0.1","proto":"HTTP/1.1","method":"GET","host":"medforge.localtest.me:18080","uri":"/","headers":{"User-Agent":["curl/8.5.0"],"Accept":["*/*"]}},"duration":0.000359913,"status":502,"err_id":"6k76nvdnp","err_trace":"reverseproxy.statusError (reverseproxy.go:1390)"}
```
