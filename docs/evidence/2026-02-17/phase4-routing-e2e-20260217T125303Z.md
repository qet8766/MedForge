## Phase 4 Routing and End-to-End Evidence (2026-02-17)

Generated by: `@ops/host/validate-phase4-routing-e2e.sh`

Runtime:
- phase id: `phase4-routing-e2e`
- run id: `20260217T125303Z`
- external web URL: `https://external.medforge.medforge.xyz`
- external api URL: `https://api.medforge.medforge.xyz`
- pack image: `medforge-pack-default@sha256:7e44d4e67aa5c7bbc51701be7f370f45de35794cc7f2504f761b1a510f1c1a6e`
- enforce stop B snapshot: `0`
- playwright install mode: `auto`


### Remote-External Preflight

medforge.medforge.xyz.
61.72.69.176
medforge.medforge.xyz.
61.72.69.176
medforge.medforge.xyz.
61.72.69.176
- DNS + TLS + health preflight: PASS
- duration_s: `0`

### Auth Session Bootstrap

- auth bootstrap: PASS
- duration_s: `1`

### Create Sessions

- create A: `{"data":{"message":"Session started.","session":{"id":"50ad824a-31e1-469f-833e-a069bbcd90e7","user_id":"b1415639-5ce1-4ef7-8eb5-434aa653cf07","exposure":"external","pack_id":"00000000-0000-0000-0000-000000000100","status":"running","container_id":"670d9e73d1af3e5db089d276151286ee2fa8fd787c1fd5c93910af47ef376a44","gpu_id":2,"slug":"nversyf4","workspace_zfs":"tank/medforge/workspaces/b1415639-5ce1-4ef7-8eb5-434aa653cf07/50ad824a-31e1-469f-833e-a069bbcd90e7","created_at":"2026-02-17T12:53:04.417429","started_at":"2026-02-17T12:53:05","stopped_at":null,"error_message":null}},"meta":{"request_id":"97de7367-23d6-40f5-a6f0-a5727c6fc7f0","api_version":"v2.0","timestamp":"2026-02-17T12:53:05.083883Z","limit":null,"next_cursor":null,"has_more":null}}`
- create B: `{"data":{"message":"Session started.","session":{"id":"acc392a1-6be3-4db6-bf5a-2fafdb6119fb","user_id":"d13596fe-a2b4-44d4-99ef-da45c6d31a35","exposure":"external","pack_id":"00000000-0000-0000-0000-000000000100","status":"running","container_id":"ed042de323bfc3b874453f618716b44060241f9fe62532c79e225e61d8f18fb2","gpu_id":3,"slug":"xxfm4aai","workspace_zfs":"tank/medforge/workspaces/d13596fe-a2b4-44d4-99ef-da45c6d31a35/acc392a1-6be3-4db6-bf5a-2fafdb6119fb","created_at":"2026-02-17T12:53:04.422822","started_at":"2026-02-17T12:53:05","stopped_at":null,"error_message":null}},"meta":{"request_id":"42f46fa7-53db-4ee2-af46-902807bccc17","api_version":"v2.0","timestamp":"2026-02-17T12:53:05.108735Z","limit":null,"next_cursor":null,"has_more":null}}`
- duration_s: `1`

### Routing Authorization Matrix

- unauthenticated wildcard root: `401` body=`{"type":"https://medforge.dev/problems/http/401","title":"Unauthorized","status":401,"detail":"Authentication required.","instance":"/api/v2/auth/session-proxy","code":"401","request_id":"5ec5ef55-8487-4778-af05-9a864d6f1e2a"}`
- non-owner wildcard root: `403` body=`{"type":"https://medforge.dev/problems/http/403","title":"Forbidden","status":403,"detail":"Session access denied.","instance":"/api/v2/auth/session-proxy","code":"403","request_id":"187eba3a-b93c-4d9a-bc5e-bfaa302e54ef"}`
- owner wildcard root: `200`
- blocked wildcard internal path unauthenticated: `403` body=`Forbidden`
- blocked wildcard internal path owner: `403` body=`Forbidden`
- owner spoof attempt via api host: `200` x-upstream=`mf-session-nversyf4:8080`
- duration_s: `0`

### East-West Isolation

- firewall: `East–west isolation applied (bridge=br-0c9d5325b4f3, caddy=172.30.0.2)`
- session B -> session A :8080 blocked (exit=`28`, stderr=`curl: (28) Connection timed out after 3002 milliseconds`)
- duration_s: `4`

### End-to-End Core Runtime

- GPU in session A: `NVIDIA GeForce RTX 5090`
- workspace write/read: `alpha`
- stop A: `{"data":{"message":"Session stop requested."},"meta":{"request_id":"cb13b906-1fe4-40f1-bb04-ab55095ff545","api_version":"v2.0","timestamp":"2026-02-17T12:53:09.362982Z","limit":null,"next_cursor":null,"has_more":null}}`
- stopped host check: `404` body=`{"type":"https://medforge.dev/problems/http/404","title":"Not Found","status":404,"detail":"Session not found.","instance":"/api/v2/auth/session-proxy","code":"404","request_id":"fd4c6ad4-185a-49cc-80f6-44178f36dccb"}`
- snapshot: `tank/medforge/workspaces/b1415639-5ce1-4ef7-8eb5-434aa653cf07/50ad824a-31e1-469f-833e-a069bbcd90e7@stop-1771332791833`
- stop B: `{"data":{"message":"Session stop requested."},"meta":{"request_id":"bfab6019-55d4-415e-b44c-6e5b0e972b2b","api_version":"v2.0","timestamp":"2026-02-17T12:53:13.155290Z","limit":null,"next_cursor":null,"has_more":null}}`
- stop B snapshot wait: skipped (PHASE4_ENFORCE_STOP_B_SNAPSHOT=0)
- duration_s: `4`

### Browser + Websocket Lane

- playwright chromium install: skipped (mode=`auto`)
- browser base URL: `https://external.medforge.medforge.xyz`
- e2e user: `e2e-1771332783@medforge.test`
- wildcard session URL: `https://s-qwhkunbf.external.medforge.medforge.xyz`
- wildcard slug: `qwhkunbf`
- websocket attempts observed: `1`
- websocket connections with frame traffic: `1`
- duration_s: `16`

### Compose Log Snippets

```text
medforge-api    | INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
medforge-caddy  | {"level":"info","ts":1771332247.3085024,"msg":"maxprocs: Leaving GOMAXPROCS=128: CPU quota undefined"}
medforge-api    | 2026-02-17 12:44:08 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=29a2777e-2373-4108-858e-e535c381eafa recovery_mode=startup session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:44:08 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=29a2777e-2373-4108-858e-e535c381eafa recovery_mode=startup session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:44:08 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=7c2a004d-7c32-4414-aaab-ee09f993ff71 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-caddy  | {"level":"info","ts":1771332247.3085914,"msg":"GOMEMLIMIT is updated","package":"github.com/KimMachineGun/automemlimit/memlimit","GOMEMLIMIT":486097462886,"previous":9223372036854775807}
medforge-caddy  | {"level":"info","ts":1771332247.3086064,"msg":"using config from file","file":"/etc/caddy/Caddyfile"}
medforge-caddy  | {"level":"warn","ts":1771332247.3092072,"logger":"caddyfile","msg":"Unnecessary header_up X-Forwarded-For: the reverse proxy's default behavior is to pass headers to the upstream"}
medforge-caddy  | {"level":"warn","ts":1771332247.3092542,"logger":"caddyfile","msg":"Unnecessary header_up X-Forwarded-Proto: the reverse proxy's default behavior is to pass headers to the upstream"}
medforge-caddy  | {"level":"warn","ts":1771332247.3093946,"logger":"caddyfile","msg":"Unnecessary header_up X-Forwarded-For: the reverse proxy's default behavior is to pass headers to the upstream"}
medforge-caddy  | {"level":"warn","ts":1771332247.3094223,"logger":"caddyfile","msg":"Unnecessary header_up X-Forwarded-Proto: the reverse proxy's default behavior is to pass headers to the upstream"}
medforge-caddy  | {"level":"info","ts":1771332247.3099513,"msg":"adapted config to JSON","adapter":"caddyfile"}
medforge-api    | 2026-02-17 12:44:08 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=7c2a004d-7c32-4414-aaab-ee09f993ff71 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:44:25 [info     ] session.start                  exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 request_id=655ae1f7-f0c9-4d84-a7a2-0e03e80f0dd7 session_id=844ab2fd-ffc7-430d-8c10-9a7a2351170e slug=r45svbbc user_id=fe1288cc-911a-40fc-9ea6-77cd900709ad
medforge-api    | 2026-02-17 12:44:38 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=de821b3d-1615-476e-8fff-d0c89975600f recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:44:38 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=de821b3d-1615-476e-8fff-d0c89975600f recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:44:39 [info     ] session.stop                   correlation_id=de821b3d-1615-476e-8fff-d0c89975600f exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 reason=requested recovery_mode=poll session_id=844ab2fd-ffc7-430d-8c10-9a7a2351170e slug=r45svbbc user_id=fe1288cc-911a-40fc-9ea6-77cd900709ad
medforge-api    | 2026-02-17 12:44:39 [info     ] session.poll.updated           correlation_id=de821b3d-1615-476e-8fff-d0c89975600f recovery_mode=poll updated=1
medforge-api    | 2026-02-17 12:44:45 [info     ] session.start                  exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 request_id=cefb6c47-c0bd-48f5-8f83-b109a1cb4df1 session_id=7b5af05f-3687-4637-9493-cacc9bae0b36 slug=wyi2j5ro user_id=b1415639-5ce1-4ef7-8eb5-434aa653cf07
medforge-api    | 2026-02-17 12:44:45 [info     ] session.start                  exposure=EXTERNAL gpu_id=3 pack_id=00000000-0000-0000-0000-000000000100 request_id=1f153772-ea85-44cc-b8ec-320a2bde21ae session_id=4a417238-a169-431c-8b0f-995bdc69dbef slug=mgvf6wse user_id=d13596fe-a2b4-44d4-99ef-da45c6d31a35
medforge-api    | 2026-02-17 12:45:09 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=b445f20e-abda-4af8-8404-079b1d1fb000 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:45:09 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=b445f20e-abda-4af8-8404-079b1d1fb000 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:45:09 [info     ] session.stop                   correlation_id=b445f20e-abda-4af8-8404-079b1d1fb000 exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 reason=requested recovery_mode=poll session_id=7b5af05f-3687-4637-9493-cacc9bae0b36 slug=wyi2j5ro user_id=b1415639-5ce1-4ef7-8eb5-434aa653cf07
medforge-api    | 2026-02-17 12:45:09 [info     ] session.recovery.decision      container_id=d2223157006acb2c22d5f8455e26e309bfd8ba9e6f77a13b3a215a887c7596d5 correlation_id=b445f20e-abda-4af8-8404-079b1d1fb000 recovery_mode=poll session_id=4a417238-a169-431c-8b0f-995bdc69dbef slug=mgvf6wse state=running user_id=d13596fe-a2b4-44d4-99ef-da45c6d31a35
medforge-api    | 2026-02-17 12:45:09 [info     ] session.poll.updated           correlation_id=b445f20e-abda-4af8-8404-079b1d1fb000 recovery_mode=poll updated=1
medforge-api    | 2026-02-17 12:45:39 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=7d557324-835d-43f9-ba9a-81fb42eddec2 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:45:39 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=7d557324-835d-43f9-ba9a-81fb42eddec2 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:45:39 [info     ] session.stop                   correlation_id=7d557324-835d-43f9-ba9a-81fb42eddec2 exposure=EXTERNAL gpu_id=3 pack_id=00000000-0000-0000-0000-000000000100 reason=requested recovery_mode=poll session_id=4a417238-a169-431c-8b0f-995bdc69dbef slug=mgvf6wse user_id=d13596fe-a2b4-44d4-99ef-da45c6d31a35
medforge-api    | 2026-02-17 12:45:39 [info     ] session.poll.updated           correlation_id=7d557324-835d-43f9-ba9a-81fb42eddec2 recovery_mode=poll updated=1
medforge-api    | 2026-02-17 12:45:53 [info     ] session.start                  exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 request_id=c663d652-3727-4023-bc8f-2224f12ad585 session_id=82600e74-d4c1-4d7d-949d-995a45d2184f slug=y5ogtcub user_id=edcb668d-5838-4b8e-9afa-57a82b2fe0e5
medforge-api    | 2026-02-17 12:46:09 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=ab2afd8f-5a99-4551-8c55-72e74fd233fe recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:46:09 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=ab2afd8f-5a99-4551-8c55-72e74fd233fe recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:46:11 [info     ] session.stop                   correlation_id=ab2afd8f-5a99-4551-8c55-72e74fd233fe exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 reason=requested recovery_mode=poll session_id=82600e74-d4c1-4d7d-949d-995a45d2184f slug=y5ogtcub user_id=edcb668d-5838-4b8e-9afa-57a82b2fe0e5
medforge-api    | 2026-02-17 12:46:11 [info     ] session.poll.updated           correlation_id=ab2afd8f-5a99-4551-8c55-72e74fd233fe recovery_mode=poll updated=1
medforge-api    | 2026-02-17 12:46:41 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=6642f488-048c-4eef-8383-3f3ac68d1c23 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:46:41 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=6642f488-048c-4eef-8383-3f3ac68d1c23 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-caddy  | {"level":"info","ts":1771332247.3107216,"logger":"admin","msg":"admin endpoint started","address":"localhost:2019","enforce_origin":false,"origins":["//localhost:2019","//[::1]:2019","//127.0.0.1:2019"]}
medforge-api    | 2026-02-17 12:47:11 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=c4b90524-486c-480c-9812-5ec08a3cff9f recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-caddy  | {"level":"info","ts":1771332247.310899,"logger":"http.auto_https","msg":"server is listening only on the HTTPS port but has no TLS connection policies; adding one to enable TLS","server_name":"srv0","https_port":443}
medforge-api    | 2026-02-17 12:47:11 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=c4b90524-486c-480c-9812-5ec08a3cff9f recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:47:41 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=c40e5f14-213e-407d-aa5d-fb24c8cd0347 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-web    | ▲ Next.js 16.1.6
medforge-web    | - Local:         http://localhost:3000
medforge-web    | - Network:       http://0.0.0.0:3000
medforge-web    | 
medforge-web    | ✓ Starting...
medforge-web    | ✓ Ready in 41ms
medforge-web    | ⨯ TypeError: fetch failed
medforge-caddy  | {"level":"info","ts":1771332247.3109097,"logger":"http.auto_https","msg":"enabling automatic HTTP->HTTPS redirects","server_name":"srv0"}
medforge-api    | 2026-02-17 12:47:41 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=c40e5f14-213e-407d-aa5d-fb24c8cd0347 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-web    |     at async j (.next/server/chunks/ssr/_f1e96812._.js:4:23144)
medforge-api    | 2026-02-17 12:48:11 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=91f3d2df-d85a-4727-8836-4408f476e74e recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:48:11 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=91f3d2df-d85a-4727-8836-4408f476e74e recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-web    |     at async j (.next/server/chunks/ssr/_b5e6fe96._.js:1:8330) {
medforge-caddy  | {"level":"info","ts":1771332247.3109775,"logger":"tls.cache.maintenance","msg":"started background certificate maintenance","cache":"0x146a9d88680"}
medforge-web    |   digest: '2299262665',
medforge-web    |   [cause]: Error: connect ECONNREFUSED 172.18.0.5:8000
medforge-caddy  | {"level":"info","ts":1771332247.311818,"logger":"http","msg":"enabling HTTP/3 listener","addr":":443"}
medforge-web    |       at <unknown> (Error: connect ECONNREFUSED 172.18.0.5:8000) {
medforge-caddy  | {"level":"info","ts":1771332247.3119006,"logger":"http.log","msg":"server running","name":"srv0","protocols":["h1","h2","h3"]}
medforge-web    |     errno: -111,
medforge-caddy  | {"level":"warn","ts":1771332247.3119156,"logger":"http","msg":"HTTP/2 skipped because it requires TLS","network":"tcp","addr":":80"}
medforge-web    |     code: 'ECONNREFUSED',
medforge-caddy  | {"level":"warn","ts":1771332247.3119173,"logger":"http","msg":"HTTP/3 skipped because it requires TLS","network":"tcp","addr":":80"}
medforge-web    |     syscall: 'connect',
medforge-web    |     address: '172.18.0.5',
medforge-caddy  | {"level":"info","ts":1771332247.3119183,"logger":"http.log","msg":"server running","name":"remaining_auto_https_redirects","protocols":["h1","h2","h3"]}
medforge-web    |     port: 8000
medforge-web    |   }
medforge-web    | }
medforge-caddy  | {"level":"info","ts":1771332247.3119202,"logger":"http","msg":"enabling automatic TLS certificate management","domains":["internal.medforge.medforge.xyz","api.medforge.medforge.xyz","medforge.medforge.xyz","*.external.medforge.medforge.xyz","*.internal.medforge.medforge.xyz","external.medforge.medforge.xyz"]}
medforge-api    | 2026-02-17 12:48:41 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=fee3a30f-6986-425b-a4f8-25074deda85f recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-caddy  | {"level":"info","ts":1771332247.3140259,"msg":"autosaved config (load with --resume flag)","file":"/config/caddy/autosave.json"}
medforge-caddy  | {"level":"info","ts":1771332247.314048,"msg":"serving initial configuration"}
medforge-caddy  | {"level":"info","ts":1771332247.315604,"logger":"tls","msg":"storage cleaning happened too recently; skipping for now","storage":"FileStorage:/data/caddy","instance":"ee5e951a-3cd9-48f9-a27d-2b27b46567f3","try_again":1771418647.3156025,"try_again_in":86399.9999998}
medforge-caddy  | {"level":"info","ts":1771332247.3156545,"logger":"tls","msg":"finished cleaning storage units"}
medforge-caddy  | {"level":"error","ts":1771332247.8537679,"logger":"http.log.error","msg":"dial tcp 172.18.0.5:8000: connect: connection refused","request":{"remote_ip":"61.72.69.176","remote_port":"36484","client_ip":"61.72.69.176","proto":"HTTP/2.0","method":"GET","host":"api.medforge.medforge.xyz","uri":"/healthz","headers":{"User-Agent":["curl/8.5.0"],"Accept":["*/*"]},"tls":{"resumed":false,"version":772,"cipher_suite":4865,"proto":"h2","server_name":"api.medforge.medforge.xyz"}},"duration":0.000640118,"status":502,"err_id":"3jpju8r5p","err_trace":"reverseproxy.statusError (reverseproxy.go:1390)"}
medforge-caddy  | {"level":"warn","ts":1771332247.9406464,"logger":"http.handlers.reverse_proxy","msg":"aborting with incomplete response","upstream":"medforge-web:3000","duration":0.087017876,"request":{"remote_ip":"61.72.69.176","remote_port":"36482","client_ip":"61.72.69.176","proto":"HTTP/2.0","method":"GET","host":"external.medforge.medforge.xyz","uri":"/","headers":{"Accept":["*/*"],"X-Forwarded-For":["61.72.69.176"],"X-Forwarded-Proto":["https"],"X-Forwarded-Host":["external.medforge.medforge.xyz"],"Via":["2.0 Caddy"],"User-Agent":["curl/8.5.0"]},"tls":{"resumed":false,"version":772,"cipher_suite":4865,"proto":"h2","server_name":"external.medforge.medforge.xyz"}},"error":"reading: context canceled"}
medforge-caddy  | {"level":"error","ts":1771332248.876704,"logger":"http.log.error","msg":"dial tcp 172.18.0.5:8000: connect: connection refused","request":{"remote_ip":"61.72.69.176","remote_port":"36496","client_ip":"61.72.69.176","proto":"HTTP/2.0","method":"GET","host":"api.medforge.medforge.xyz","uri":"/healthz","headers":{"User-Agent":["curl/8.5.0"],"Accept":["*/*"]},"tls":{"resumed":false,"version":772,"cipher_suite":4865,"proto":"h2","server_name":"api.medforge.medforge.xyz"}},"duration":0.000413275,"status":502,"err_id":"imitfiufw","err_trace":"reverseproxy.statusError (reverseproxy.go:1390)"}
medforge-caddy  | {"level":"error","ts":1771332266.0220382,"logger":"http.log.error","msg":"dial tcp 172.30.0.6:8080: connect: connection refused","request":{"remote_ip":"61.72.69.176","remote_port":"48676","client_ip":"61.72.69.176","proto":"HTTP/2.0","method":"GET","host":"s-r45svbbc.external.medforge.medforge.xyz","uri":"/","headers":{"User-Agent":["curl/8.5.0"],"Accept":["*/*"],"Cookie":["REDACTED"]},"tls":{"resumed":false,"version":772,"cipher_suite":4865,"proto":"h2","server_name":"s-r45svbbc.external.medforge.medforge.xyz"}},"duration":0.006715504,"status":502,"err_id":"dgvkqhfvz","err_trace":"reverseproxy.statusError (reverseproxy.go:1390)"}
medforge-caddy  | {"level":"error","ts":1771332353.6945074,"logger":"http.log.error","msg":"dial tcp 172.30.0.6:8080: connect: connection refused","request":{"remote_ip":"61.72.69.176","remote_port":"57442","client_ip":"61.72.69.176","proto":"HTTP/2.0","method":"GET","host":"s-y5ogtcub.external.medforge.medforge.xyz","uri":"/","headers":{"Sec-Fetch-Dest":["document"],"Cookie":["REDACTED"],"Sec-Fetch-Mode":["navigate"],"Accept-Encoding":["gzip, deflate, br, zstd"],"Priority":["u=0, i"],"User-Agent":["Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.6998.35 Safari/537.36"],"Sec-Fetch-User":["?1"],"Sec-Ch-Ua-Platform":["\"Windows\""],"Upgrade-Insecure-Requests":["1"],"Accept-Language":["en-US"],"Accept":["text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"],"Sec-Fetch-Site":["none"],"Sec-Ch-Ua":["\"Chromium\";v=\"134\", \"Not:A-Brand\";v=\"24\", \"HeadlessChrome\";v=\"134\""],"Sec-Ch-Ua-Mobile":["?0"]},"tls":{"resumed":false,"version":772,"cipher_suite":4865,"proto":"h2","server_name":"s-y5ogtcub.external.medforge.medforge.xyz"}},"duration":0.027668976,"status":502,"err_id":"mrvudvvgd","err_trace":"reverseproxy.statusError (reverseproxy.go:1390)"}
medforge-caddy  | {"level":"error","ts":1771332805.7734797,"logger":"http.log.error","msg":"dial tcp 172.30.0.6:8080: connect: connection refused","request":{"remote_ip":"61.72.69.176","remote_port":"52268","client_ip":"61.72.69.176","proto":"HTTP/2.0","method":"GET","host":"s-qwhkunbf.external.medforge.medforge.xyz","uri":"/","headers":{"User-Agent":["Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.6998.35 Safari/537.36"],"Sec-Fetch-Mode":["navigate"],"Sec-Fetch-Dest":["document"],"Sec-Ch-Ua-Platform":["\"Windows\""],"Accept":["text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"],"Sec-Ch-Ua-Mobile":["?0"],"Accept-Language":["en-US"],"Sec-Fetch-Site":["none"],"Sec-Ch-Ua":["\"Chromium\";v=\"134\", \"Not:A-Brand\";v=\"24\", \"HeadlessChrome\";v=\"134\""],"Sec-Fetch-User":["?1"],"Accept-Encoding":["gzip, deflate, br, zstd"],"Cookie":["REDACTED"],"Priority":["u=0, i"],"Upgrade-Insecure-Requests":["1"]},"tls":{"resumed":false,"version":772,"cipher_suite":4865,"proto":"h2","server_name":"s-qwhkunbf.external.medforge.medforge.xyz"}},"duration":0.025938454,"status":502,"err_id":"sr33r0s51","err_trace":"reverseproxy.statusError (reverseproxy.go:1390)"}
medforge-api    | 2026-02-17 12:48:41 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=fee3a30f-6986-425b-a4f8-25074deda85f recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:49:11 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=7c90d249-5fdd-49d1-8ed8-d476eff85723 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:49:11 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=7c90d249-5fdd-49d1-8ed8-d476eff85723 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:49:41 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=4d63fbb8-56cc-4e71-9421-97f7fc89bcf4 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:49:41 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=4d63fbb8-56cc-4e71-9421-97f7fc89bcf4 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:50:11 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=acc65ecd-2e67-4c98-90fe-9268753477b0 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:50:11 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=acc65ecd-2e67-4c98-90fe-9268753477b0 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:50:41 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=b2160d34-fb2c-4577-a941-4a0dbd8fffa2 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:50:41 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=b2160d34-fb2c-4577-a941-4a0dbd8fffa2 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:51:11 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=5ad829e6-b39f-44a9-a1dd-e6971c3dfdbf recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:51:11 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=5ad829e6-b39f-44a9-a1dd-e6971c3dfdbf recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:51:41 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=a7972e03-376e-496e-befe-5ea51df0cef2 recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:51:41 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=a7972e03-376e-496e-befe-5ea51df0cef2 recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:52:11 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=33c23557-9712-4dfd-ba4e-4d7273006e9e recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:52:11 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=33c23557-9712-4dfd-ba4e-4d7273006e9e recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:52:41 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=d7f9c0a9-30b4-4c56-bf27-f93ee66502cb recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:52:41 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=d7f9c0a9-30b4-4c56-bf27-f93ee66502cb recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:53:05 [info     ] session.start                  exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 request_id=97de7367-23d6-40f5-a6f0-a5727c6fc7f0 session_id=50ad824a-31e1-469f-833e-a069bbcd90e7 slug=nversyf4 user_id=b1415639-5ce1-4ef7-8eb5-434aa653cf07
medforge-api    | 2026-02-17 12:53:05 [info     ] session.start                  exposure=EXTERNAL gpu_id=3 pack_id=00000000-0000-0000-0000-000000000100 request_id=42f46fa7-53db-4ee2-af46-902807bccc17 session_id=acc392a1-6be3-4db6-bf5a-2fafdb6119fb slug=xxfm4aai user_id=d13596fe-a2b4-44d4-99ef-da45c6d31a35
medforge-api    | 2026-02-17 12:53:11 [info     ] session.recovery.decision      container_id=6e0d05ff3558065fcf6eb11f56499205afafcee7d59feb7437f9ee11882c33dc correlation_id=11a8e0b2-86f7-4c74-bb65-e7c8dd8802ab recovery_mode=poll session_id=ad5c315e-e9c3-4b9e-bcee-e807ad6056fe slug=asuioev4 state=running user_id=d218a7d3-0e58-4c8c-9d98-5b063332e8d9
medforge-api    | 2026-02-17 12:53:11 [info     ] session.recovery.decision      container_id=f973d415cc1c95e22f357193d1868ffa9b747491c640d557ca7bbaf94d57948b correlation_id=11a8e0b2-86f7-4c74-bb65-e7c8dd8802ab recovery_mode=poll session_id=30a93330-8d85-430b-b2e1-f7d54b0a98f7 slug=t6nex53s state=running user_id=0fab5592-8b33-4d2d-b188-f393e6c56c90
medforge-api    | 2026-02-17 12:53:11 [info     ] session.stop                   correlation_id=11a8e0b2-86f7-4c74-bb65-e7c8dd8802ab exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 reason=requested recovery_mode=poll session_id=50ad824a-31e1-469f-833e-a069bbcd90e7 slug=nversyf4 user_id=b1415639-5ce1-4ef7-8eb5-434aa653cf07
medforge-api    | 2026-02-17 12:53:11 [info     ] session.recovery.decision      container_id=ed042de323bfc3b874453f618716b44060241f9fe62532c79e225e61d8f18fb2 correlation_id=11a8e0b2-86f7-4c74-bb65-e7c8dd8802ab recovery_mode=poll session_id=acc392a1-6be3-4db6-bf5a-2fafdb6119fb slug=xxfm4aai state=running user_id=d13596fe-a2b4-44d4-99ef-da45c6d31a35
medforge-api    | 2026-02-17 12:53:11 [info     ] session.poll.updated           correlation_id=11a8e0b2-86f7-4c74-bb65-e7c8dd8802ab recovery_mode=poll updated=1
medforge-api    | 2026-02-17 12:53:25 [info     ] session.start                  exposure=EXTERNAL gpu_id=2 pack_id=00000000-0000-0000-0000-000000000100 request_id=c52a4f74-1142-41f9-b6ba-548972dc3d7d session_id=080dfc1f-150d-49a1-bfe7-cc16b1a52ac9 slug=qwhkunbf user_id=8427cdb9-9bb1-4527-b99b-63d851581b05
```
- duration_s: `0`
## Verdict
- phase: `phase4-routing-e2e`
- status: PASS
- log: `/home/shk/projects/MedForge/docs/evidence/2026-02-17/phase4-routing-e2e-20260217T125303Z.log`
