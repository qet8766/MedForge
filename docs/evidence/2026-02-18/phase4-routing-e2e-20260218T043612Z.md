## Phase 4 Routing and End-to-End Evidence (2026-02-18)

Generated by: `ops/host/validate-phase4-routing-e2e.sh`

Runtime:
- phase id: `phase4-routing-e2e`
- run id: `20260218T043612Z`
- external web URL: `https://external.medforge.medforge.xyz`
- external api URL: `https://api.medforge.medforge.xyz`
- pack image: `medforge-pack-default@sha256:7e44d4e67aa5c7bbc51701be7f370f45de35794cc7f2504f761b1a510f1c1a6e`
- enforce stop B snapshot: `0`
- playwright install mode: `auto`


### Remote-External Preflight

medforge.medforge.xyz.
61.72.69.176
medforge.medforge.xyz.
61.72.69.176
medforge.medforge.xyz.
61.72.69.176
- DNS + TLS + health preflight: PASS
- duration_s: `0`

### Auth Session Bootstrap

- auth bootstrap: PASS
- duration_s: `1`

### Create Sessions

- create A: `{"data":{"message":"Session started.","session":{"id":"9d5acf65-16ee-4aa6-8e12-3c5df6cd5383","user_id":"b1415639-5ce1-4ef7-8eb5-434aa653cf07","exposure":"external","pack_id":"00000000-0000-0000-0000-000000000100","status":"running","container_id":"6c3a06dc2a6a18f8ed5eb04e8cf95cbba52d93b9d9d9148432e9287dbcf91fa7","gpu_id":4,"slug":"6sox5iaj","workspace_zfs":"tank/medforge/workspaces/b1415639-5ce1-4ef7-8eb5-434aa653cf07/9d5acf65-16ee-4aa6-8e12-3c5df6cd5383","created_at":"2026-02-18T04:36:13.346478","started_at":"2026-02-18T04:36:14","stopped_at":null,"error_message":null}},"meta":{"request_id":"2aff9bfb-d86e-4f39-8bd0-4cbd6f275357","api_version":"v2.0","timestamp":"2026-02-18T04:36:14.040255Z","limit":null,"next_cursor":null,"has_more":null}}`
- create B: `{"data":{"message":"Session started.","session":{"id":"2c32eaee-3184-44c6-bc73-9e771f6e28ba","user_id":"d13596fe-a2b4-44d4-99ef-da45c6d31a35","exposure":"external","pack_id":"00000000-0000-0000-0000-000000000100","status":"running","container_id":"c1c5f7ae306c96b2f4359b8515edcbaa9b74b183765f3fd9c00994f631798330","gpu_id":3,"slug":"ko4x3cru","workspace_zfs":"tank/medforge/workspaces/d13596fe-a2b4-44d4-99ef-da45c6d31a35/2c32eaee-3184-44c6-bc73-9e771f6e28ba","created_at":"2026-02-18T04:36:13.342353","started_at":"2026-02-18T04:36:13","stopped_at":null,"error_message":null}},"meta":{"request_id":"04423dda-692f-4159-a5a8-73cc9e270a83","api_version":"v2.0","timestamp":"2026-02-18T04:36:13.993840Z","limit":null,"next_cursor":null,"has_more":null}}`
- duration_s: `1`

### Routing Authorization Matrix

- unauthenticated wildcard root: `401` body=`{"type":"https://medforge.dev/problems/http/401","title":"Unauthorized","status":401,"detail":"Authentication required.","instance":"/api/v2/auth/session-proxy","code":"401","request_id":"01b5ce0e-6e20-48b7-ba58-42414b3de2e2"}`
- non-owner wildcard root: `403` body=`{"type":"https://medforge.dev/problems/http/403","title":"Forbidden","status":403,"detail":"Session access denied.","instance":"/api/v2/auth/session-proxy","code":"403","request_id":"dba5f313-51c6-46df-b516-c52cf012770c"}`
- owner wildcard root: `200`
- blocked wildcard internal path unauthenticated: `403` body=`Forbidden`
- blocked wildcard internal path owner: `403` body=`Forbidden`
- owner spoof attempt via api host: `200` x-upstream=`mf-session-6sox5iaj:8080`
- duration_s: `0`

### East-West Isolation

- firewall: `Eastâ€“west isolation applied (bridge=br-0c9d5325b4f3, caddy=172.30.0.2)`
- session B -> session A :8080 blocked (exit=`28`, stderr=`curl: (28) Connection timed out after 3002 milliseconds`)
- duration_s: `4`

### End-to-End Core Runtime

- GPU in session A: `NVIDIA GeForce RTX 5090`
- workspace write/read: `alpha`
- stop A: `{"data":{"message":"Session stop requested."},"meta":{"request_id":"6c757fdf-e4de-4231-aebe-0deca8f0dbc4","api_version":"v2.0","timestamp":"2026-02-18T04:36:18.384214Z","limit":null,"next_cursor":null,"has_more":null}}`
- stopped host check: `404` body=`{"type":"https://medforge.dev/problems/http/404","title":"Not Found","status":404,"detail":"Session not found.","instance":"/api/v2/auth/session-proxy","code":"404","request_id":"a39e21aa-ee92-4e6f-8be2-a9639128ada8"}`
- snapshot: `tank/medforge/workspaces/b1415639-5ce1-4ef7-8eb5-434aa653cf07/9d5acf65-16ee-4aa6-8e12-3c5df6cd5383@stop-1771389404361`
- stop B: `{"data":{"message":"Session stop requested."},"meta":{"request_id":"a18a8a65-1b3c-42b9-93ee-52d37dd045bc","api_version":"v2.0","timestamp":"2026-02-18T04:36:45.625072Z","limit":null,"next_cursor":null,"has_more":null}}`
- stop B snapshot wait: skipped (PHASE4_ENFORCE_STOP_B_SNAPSHOT=0)
- duration_s: `27`

### Browser + Websocket Lane

- playwright chromium install: skipped (mode=`auto`)
## Verdict
- phase: `phase4-routing-e2e`
- status: FAIL
- log: `/home/shk/projects/MedForge/docs/evidence/2026-02-18/phase4-routing-e2e-20260218T043612Z.log`
