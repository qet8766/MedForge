## Phase 4 Routing and End-to-End Evidence (2026-02-18)

Generated by: `ops/host/validate-phase4-routing-e2e.sh`

Runtime:
- phase id: `phase4-routing-e2e`
- run id: `20260218T043040Z`
- external web URL: `https://external.medforge.medforge.xyz`
- external api URL: `https://api.medforge.medforge.xyz`
- pack image: `medforge-pack-default@sha256:7e44d4e67aa5c7bbc51701be7f370f45de35794cc7f2504f761b1a510f1c1a6e`
- enforce stop B snapshot: `0`
- playwright install mode: `auto`


### Remote-External Preflight

medforge.medforge.xyz.
61.72.69.176
medforge.medforge.xyz.
61.72.69.176
medforge.medforge.xyz.
61.72.69.176
- DNS + TLS + health preflight: PASS
- duration_s: `1`

### Auth Session Bootstrap

- auth bootstrap: PASS
- duration_s: `0`

### Create Sessions

- create A: `{"data":{"message":"Session started.","session":{"id":"c8a5e44c-d58e-4d78-a431-704b3ea221e1","user_id":"b1415639-5ce1-4ef7-8eb5-434aa653cf07","exposure":"external","pack_id":"00000000-0000-0000-0000-000000000100","status":"running","container_id":"45c2af29e629ce1a7abba13f78f9ab91f4cf9b637986f61871bec36491db6e21","gpu_id":4,"slug":"zhmgei2n","workspace_zfs":"tank/medforge/workspaces/b1415639-5ce1-4ef7-8eb5-434aa653cf07/c8a5e44c-d58e-4d78-a431-704b3ea221e1","created_at":"2026-02-18T04:30:41.529302","started_at":"2026-02-18T04:30:42","stopped_at":null,"error_message":null}},"meta":{"request_id":"85ad2231-ad96-49d1-b8ad-be5763fa15d7","api_version":"v2.0","timestamp":"2026-02-18T04:30:42.395137Z","limit":null,"next_cursor":null,"has_more":null}}`
- create B: `{"data":{"message":"Session started.","session":{"id":"75a557fc-f6e4-4644-8a50-b0078df518ae","user_id":"d13596fe-a2b4-44d4-99ef-da45c6d31a35","exposure":"external","pack_id":"00000000-0000-0000-0000-000000000100","status":"running","container_id":"de025c3b0fc4433a1ec893401b95582bfca6545434d9b23e9395bc089a6b5e08","gpu_id":3,"slug":"o6ly6ohm","workspace_zfs":"tank/medforge/workspaces/d13596fe-a2b4-44d4-99ef-da45c6d31a35/75a557fc-f6e4-4644-8a50-b0078df518ae","created_at":"2026-02-18T04:30:41.525928","started_at":"2026-02-18T04:30:42","stopped_at":null,"error_message":null}},"meta":{"request_id":"da9d9397-b944-4138-96be-61f435e79fd0","api_version":"v2.0","timestamp":"2026-02-18T04:30:42.354140Z","limit":null,"next_cursor":null,"has_more":null}}`
- duration_s: `1`

### Routing Authorization Matrix

- unauthenticated wildcard root: `401` body=`{"type":"https://medforge.dev/problems/http/401","title":"Unauthorized","status":401,"detail":"Authentication required.","instance":"/api/v2/auth/session-proxy","code":"401","request_id":"ac0cd6db-80d0-4702-99a5-39b4e77b66cf"}`
- non-owner wildcard root: `403` body=`{"type":"https://medforge.dev/problems/http/403","title":"Forbidden","status":403,"detail":"Session access denied.","instance":"/api/v2/auth/session-proxy","code":"403","request_id":"49ad51fa-0d19-43c4-b321-ce58385f5c22"}`
- owner wildcard root: `200`
- blocked wildcard internal path unauthenticated: `403` body=`Forbidden`
- blocked wildcard internal path owner: `403` body=`Forbidden`
- owner spoof attempt via api host: `200` x-upstream=`mf-session-zhmgei2n:8080`
- duration_s: `1`

### East-West Isolation

- firewall: `Eastâ€“west isolation applied (bridge=br-0c9d5325b4f3, caddy=172.30.0.2)`
- session B -> session A :8080 blocked (exit=`28`, stderr=`curl: (28) Connection timed out after 3002 milliseconds`)
- duration_s: `3`

### End-to-End Core Runtime

- GPU in session A: `NVIDIA GeForce RTX 5090`
- workspace write/read: `alpha`
- stop A: `{"data":{"message":"Session stop requested."},"meta":{"request_id":"a0f96e94-2362-4831-8d6c-35fdf7e61153","api_version":"v2.0","timestamp":"2026-02-18T04:30:46.800734Z","limit":null,"next_cursor":null,"has_more":null}}`
- stopped host check: `404` body=`{"type":"https://medforge.dev/problems/http/404","title":"Not Found","status":404,"detail":"Session not found.","instance":"/api/v2/auth/session-proxy","code":"404","request_id":"ab1d35b2-f00d-4f66-976c-d6be0fa52942"}`
- snapshot: `tank/medforge/workspaces/b1415639-5ce1-4ef7-8eb5-434aa653cf07/c8a5e44c-d58e-4d78-a431-704b3ea221e1@stop-1771389070104`
- stop B: `{"data":{"message":"Session stop requested."},"meta":{"request_id":"13b0af40-21e0-4d37-931b-867d2387a6c8","api_version":"v2.0","timestamp":"2026-02-18T04:31:10.480386Z","limit":null,"next_cursor":null,"has_more":null}}`
- stop B snapshot wait: skipped (PHASE4_ENFORCE_STOP_B_SNAPSHOT=0)
- duration_s: `24`

### Browser + Websocket Lane

- playwright chromium install: skipped (mode=`auto`)
## Verdict
- phase: `phase4-routing-e2e`
- status: FAIL
- log: `/home/shk/projects/MedForge/docs/evidence/2026-02-18/phase4-routing-e2e-20260218T043040Z.log`
